"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/[...nextapi]";
exports.ids = ["pages/api/[...nextapi]"];
exports.modules = {

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\[...nextapi].js */ \"(api)/./src/pages/api/[...nextapi].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/[...nextapi]\",\n        pathname: \"/api/[...nextapi]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRiU1Qi4uLm5leHRhcGklNUQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlNUNwYWdlcyU1Q2FwaSU1QyU1Qi4uLm5leHRhcGklNUQuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDK0Q7QUFDL0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHNEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxzREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ydWJ5LWxldGNob24vPzhmN2QiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3NyY1xcXFxwYWdlc1xcXFxhcGlcXFxcWy4uLm5leHRhcGldLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvWy4uLm5leHRhcGldXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvWy4uLm5leHRhcGldXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/[...nextapi].js":
/*!***************************************!*\
  !*** ./src/pages/api/[...nextapi].js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/authMiddleware */ \"(api)/./src/utils/authMiddleware.js\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nconst db = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: process.env.MYSQL_PORT,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    database: process.env.MYSQL_DATABASE,\n    waitForConnections: true,\n    connectionLimit: 10,\n    queueLimit: 0\n});\nasync function handler(req, res) {\n    const { method } = req;\n    const { pathname } = (0,url__WEBPACK_IMPORTED_MODULE_1__.parse)(req.url, true);\n    try {\n        switch(method){\n            case \"GET\":\n                if (pathname === \"/api/check-auth\") {\n                    return handleCheckAuth(req, res);\n                } else if (pathname === \"/api/acustomer\") {\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleGetCustomers)(req, res);\n                } else if (pathname === \"/api/aproducts\") {\n                    return handleGetProducts(req, res);\n                } else if (pathname === \"/api/aproduct-prices\") {\n                    return handleGetProductPrices(req, res);\n                } else if (pathname === \"/api/orders\") {\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleGetOrders)(req, res);\n                }\n                break;\n            case \"POST\":\n                if (pathname === \"/api/login\") {\n                    return handleLogIn(req, res);\n                } else if (pathname === \"/api/validate-pin\") {\n                    return handleValidatePin(req, res);\n                } else if (pathname === \"/api/logout\") {\n                    return handleLogout(req, res);\n                } else if (pathname === \"/api/acustomer\") {\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleAddCustomer)(req, res);\n                } else if (pathname === \"/api/orders\") {\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleGetOrders)(req, res);\n                } else if (pathname === \"/api/signup\") {\n                    return handlePostSignup(req, res);\n                }\n                break;\n            case \"PUT\":\n                if (pathname.startsWith(\"/api/aproduct/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleUpdateProduct)(req, res, id);\n                } else if (pathname.startsWith(\"/api/acustomer/\")) {\n                    const customerId = pathname.split(\"/\").pop();\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleUpdateCustomer)(req, res, customerId);\n                } else if (pathname === \"/api/orders\") {\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleAddOrder)(req, res);\n                }\n                break;\n            case \"DELETE\":\n                if (pathname.startsWith(\"/api/aproduct/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleDeleteProduct)(req, res, id);\n                } else if (pathname.startsWith(\"/api/acustomer/\")) {\n                    const customerId = pathname.split(\"/\").pop();\n                    return (0,_utils_authMiddleware__WEBPACK_IMPORTED_MODULE_3__.authMiddleware)(handleDeleteCustomer)(req, res, customerId);\n                }\n                break;\n            default:\n                res.setHeader(\"Allow\", [\n                    \"GET\",\n                    \"POST\",\n                    \"PUT\",\n                    \"DELETE\"\n                ]);\n                res.status(405).end(`Method ${method} Not Allowed`);\n        }\n    } catch (error) {\n        console.error(error);\n        res.status(500).json({\n            error: \"An error occurred while processing your request\"\n        });\n    }\n}\nasync function handleLogIn(req, res) {\n    const { emailaddress, password } = req.body;\n    try {\n        // Input validation\n        if (!emailaddress || !password) {\n            return res.status(400).json({\n                error: \"Email and password are required\"\n            });\n        }\n        // Query the database\n        const [result] = await db.query(\"SELECT * FROM acustomer WHERE emailaddress = ?\", [\n            emailaddress\n        ]);\n        // Check if user exists and password matches\n        if (result.length === 0 || !await bcrypt__WEBPACK_IMPORTED_MODULE_4___default().compare(password, result[0].password)) {\n            return res.status(401).json({\n                error: \"Invalid email or password\"\n            });\n        }\n        const user = result[0];\n        // Create JWT token - include customerid\n        const token = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)({\n            userId: user.id,\n            customerid: user.customerid,\n            email: user.emailaddress,\n            role: user.role\n        }, process.env.JWT_SECRET, {\n            expiresIn: \"5h\"\n        });\n        // Set cookie\n        res.setHeader(\"Set-Cookie\", `token=${token}; HttpOnly; Path=/; Max-Age=18000; SameSite=Strict`);\n        // Send success response\n        res.status(200).json({\n            success: true,\n            message: \"Login successful\",\n            customerid: user.customerid,\n            user: {\n                emailaddress: user.emailaddress,\n                fullname: user.fullname,\n                role: user.role\n            }\n        });\n    } catch (error) {\n        console.error(\"Login error:\", error);\n        res.status(500).json({\n            error: \"An error occurred during login\"\n        });\n    }\n}\nfunction handleCheckAuth(req, res) {\n    const token = req.cookies.token;\n    if (!token) {\n        return res.status(200).json({\n            isAuthenticated: false\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        return res.status(200).json({\n            isAuthenticated: true,\n            customerid: decoded.customerid // Add this\n        });\n    } catch (error) {\n        return res.status(200).json({\n            isAuthenticated: false\n        });\n    }\n}\n// Logout\nasync function handleLogout(req, res) {\n    try {\n        // Clear the authentication cookie\n        res.setHeader(\"Set-Cookie\", \"token=; Path=/; HttpOnly; Expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Strict\");\n        // Send success response\n        res.status(200).json({\n            success: true,\n            message: \"Logout successful\"\n        });\n    } catch (error) {\n        console.error(\"Logout error:\", error);\n        res.status(500).json({\n            error: \"An error occurred during logout\"\n        });\n    }\n}\n// Signup\nasync function handlePostSignup(req, res) {\n    const { fullname, contactnumber, emailaddress, password } = req.body;\n    // Perform basic validation\n    if (!fullname || !contactnumber || !emailaddress || !password) {\n        return res.status(400).json({\n            error: \"All fields are required\",\n            missing: {\n                fullname: !fullname,\n                contactnumber: !contactnumber,\n                emailaddress: !emailaddress,\n                password: !password\n            }\n        });\n    }\n    try {\n        // Check if the user already exists\n        const [existingUser] = await db.query(\"SELECT * FROM acustomer WHERE emailaddress = ?\", [\n            emailaddress\n        ]);\n        if (existingUser.length > 0) {\n            return res.status(409).json({\n                error: \"User already exists\"\n            });\n        }\n        // Hash the password\n        const hashedPassword = await bcrypt__WEBPACK_IMPORTED_MODULE_4___default().hash(password, 10);\n        // Insert new user\n        const [result] = await db.query(\"INSERT INTO acustomer (fullname, contactnumber, emailaddress, password) VALUES (?, ?, ?, ?)\", [\n            fullname,\n            contactnumber,\n            emailaddress,\n            hashedPassword\n        ]);\n        res.status(201).json({\n            success: true,\n            message: \"Signup successful\",\n            userId: result.insertId\n        });\n    } catch (error) {\n        console.error(\"Error during signup:\", error);\n        res.status(500).json({\n            error: \"An error occurred while creating the user\"\n        });\n    }\n}\nasync function handleGetProductPrices(req, res) {\n    try {\n        const [prices] = await db.query(`\n      SELECT \n        ap.priceid,\n        ap.productid,\n        ap.weight,\n        CAST(ap.price AS DECIMAL(10,2)) as price,\n        ap.description,\n        p.imageUrl,\n        p.name as productName\n      FROM aproduct_prices ap\n      JOIN aproducts p ON ap.productid = p.productid\n    `);\n        console.log(\"Fetched prices with product data:\", prices);\n        res.status(200).json(prices);\n    } catch (error) {\n        console.error(\"Error fetching product prices:\", error);\n        res.status(500).json({\n            error: \"Error fetching product prices\"\n        });\n    }\n}\n// Update handleGetProducts to include more details\nasync function handleGetProducts(req, res) {\n    try {\n        const [products] = await db.query(`\n      SELECT \n        p.productid,\n        p.name,\n        p.description,\n        p.imageUrl,\n        p.category\n      FROM aproducts p\n    `);\n        console.log(\"Fetched products:\", products);\n        res.status(200).json(products);\n    } catch (error) {\n        console.error(\"Error fetching products:\", error);\n        res.status(500).json({\n            error: \"Error fetching products\"\n        });\n    }\n}\n// Function to generate tracking number\nfunction generateTrackingNumber() {\n    const prefix = \"LCH\"; // Prefix for Lechon\n    const timestamp = Date.now().toString().slice(-6);\n    const random = Math.floor(Math.random() * 1000).toString().padStart(3, \"0\");\n    return `${prefix}${timestamp}${random}`;\n}\nasync function handleAddOrder(req, res) {\n    const connection = await db.getConnection();\n    try {\n        await connection.beginTransaction();\n        const { customerid, items, total_amount, payment_method, delivery_address } = req.body;\n        const tracking_number = generateTrackingNumber();\n        // Group items by their base product\n        const itemsByProduct = {};\n        for (const item of items){\n            // Get the base productid for this price\n            const [priceInfo] = await connection.query(`SELECT ap.productid, p.name \n         FROM aproduct_prices ap\n         JOIN aproducts p ON ap.productid = p.productid\n         WHERE ap.priceid = ?`, [\n                item.priceid\n            ]);\n            const productId = priceInfo[0]?.productid;\n            if (!itemsByProduct[productId]) {\n                itemsByProduct[productId] = {\n                    items: [],\n                    totalQuantity: 0,\n                    productName: priceInfo[0]?.name\n                };\n            }\n            itemsByProduct[productId].items.push(item);\n            itemsByProduct[productId].totalQuantity += item.quantity;\n        }\n        // Create orders for each unique product\n        const orderIds = [];\n        for (const [productId, productData] of Object.entries(itemsByProduct)){\n            // Calculate the subtotal for this product's items\n            const productSubtotal = productData.items.reduce((sum, item)=>sum + item.price * item.quantity, 0);\n            // Insert order for this product\n            const [orderResult] = await connection.query(`INSERT INTO orders (\n          tracking_number, \n          customerid, \n          productid,\n          quantity,\n          total_amount, \n          payment_method, \n          delivery_address,\n          status\n        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?)`, [\n                tracking_number,\n                customerid,\n                productId,\n                productData.totalQuantity,\n                productSubtotal,\n                payment_method,\n                delivery_address,\n                \"order_placed\"\n            ]);\n            const orderid = orderResult.insertId;\n            orderIds.push(orderid);\n            // Insert order items for this product\n            for (const item of productData.items){\n                await connection.query(`INSERT INTO order_items (\n            orderid, \n            priceid, \n            quantity, \n            price_at_time\n          ) VALUES (?, ?, ?, ?)`, [\n                    orderid,\n                    item.priceid,\n                    item.quantity,\n                    item.price\n                ]);\n            }\n        }\n        await connection.commit();\n        res.status(200).json({\n            orderids: orderIds,\n            tracking_number,\n            message: \"Orders created successfully\"\n        });\n    } catch (error) {\n        await connection.rollback();\n        console.error(\"Error creating orders:\", error);\n        res.status(500).json({\n            error: \"Error creating orders\"\n        });\n    } finally{\n        connection.release();\n    }\n}\nasync function handleGetOrders(req, res) {\n    try {\n        // Modified query to include customer details from acustomer table\n        const [orders] = await db.query(`\n      SELECT \n        o.*,\n        c.fullname,\n        c.contactNumber,\n        c.emailaddress\n      FROM orders o\n      JOIN acustomer c ON o.customerid = c.customerid\n      ORDER BY o.date DESC\n    `);\n        // Fetch items for each order\n        for (let order of orders){\n            const [items] = await db.query(`\n        SELECT \n          oi.*,\n          ap.weight,\n          ap.description,\n          p.name,\n          p.imageUrl\n        FROM order_items oi\n        JOIN aproduct_prices ap ON oi.priceid = ap.priceid\n        JOIN aproducts p ON ap.productid = p.productid\n        WHERE oi.orderid = ?\n      `, [\n                order.orderid\n            ]);\n            order.items = items;\n        }\n        res.status(200).json(orders);\n    } catch (error) {\n        console.error(\"Error fetching orders:\", error);\n        res.status(500).json({\n            error: \"Error fetching orders\"\n        });\n    }\n} // Other functions (handleGetCustomers, handleAddOrder, etc.) would go here\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU0sQ0FBQyxLQUFLSSxJQUFJLENBQUM7WUFDbkJzRSxVQUFVWDtZQUNWWjtZQUNBaEMsU0FBUztRQUNYO0lBQ0YsRUFBRSxPQUFPakIsT0FBTztRQUNkLE1BQU0wQyxXQUFXK0IsUUFBUTtRQUN6QnhFLFFBQVFELEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDM0IsSUFBSXlCLE1BQU0sQ0FBQyxLQUFLSSxJQUFJLENBQUM7WUFBRUYsT0FBTztRQUF3QjtJQUN4RCxTQUFVO1FBQ1IwQyxXQUFXZ0MsT0FBTztJQUNwQjtBQUNGO0FBRUEsZUFBZTdGLGdCQUFnQlQsR0FBRyxFQUFFQyxHQUFHO0lBQ3JDLElBQUk7UUFDRixrRUFBa0U7UUFDbEUsTUFBTSxDQUFDc0csT0FBTyxHQUFHLE1BQU16SCxHQUFHb0QsS0FBSyxDQUFDLENBQUM7Ozs7Ozs7OztJQVNqQyxDQUFDO1FBRUQsNkJBQTZCO1FBQzdCLEtBQUssSUFBSXNFLFNBQVNELE9BQVE7WUFDeEIsTUFBTSxDQUFDOUIsTUFBTSxHQUFHLE1BQU0zRixHQUFHb0QsS0FBSyxDQUFDLENBQUM7Ozs7Ozs7Ozs7O01BV2hDLENBQUMsRUFBRTtnQkFBQ3NFLE1BQU1OLE9BQU87YUFBQztZQUVsQk0sTUFBTS9CLEtBQUssR0FBR0E7UUFDaEI7UUFFQXhFLElBQUl5QixNQUFNLENBQUMsS0FBS0ksSUFBSSxDQUFDeUU7SUFDdkIsRUFBRSxPQUFPM0UsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QzNCLElBQUl5QixNQUFNLENBQUMsS0FBS0ksSUFBSSxDQUFDO1lBQUVGLE9BQU87UUFBd0I7SUFDeEQ7QUFDRixFQUVBLDJFQUEyRSIsInNvdXJjZXMiOlsid2VicGFjazovL3J1YnktbGV0Y2hvbi8uL3NyYy9wYWdlcy9hcGkvWy4uLm5leHRhcGldLmpzPzI4NzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcbmltcG9ydCB7IHBhcnNlIH0gZnJvbSAndXJsJztcbmltcG9ydCB7IHNpZ24sIHZlcmlmeSB9IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5pbXBvcnQgeyBhdXRoTWlkZGxld2FyZSB9IGZyb20gJy4uLy4uL3V0aWxzL2F1dGhNaWRkbGV3YXJlJztcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0JztcblxuY29uc3QgZGIgPSBteXNxbC5jcmVhdGVQb29sKHtcbiAgaG9zdDogcHJvY2Vzcy5lbnYuTVlTUUxfSE9TVCxcbiAgcG9ydDogcHJvY2Vzcy5lbnYuTVlTUUxfUE9SVCxcbiAgdXNlcjogcHJvY2Vzcy5lbnYuTVlTUUxfVVNFUixcbiAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52Lk1ZU1FMX1BBU1NXT1JELFxuICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuTVlTUUxfREFUQUJBU0UsXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcbiAgY29ubmVjdGlvbkxpbWl0OiAxMCxcbiAgcXVldWVMaW1pdDogMCxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIGNvbnN0IHsgbWV0aG9kIH0gPSByZXE7XG4gIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHBhcnNlKHJlcS51cmwsIHRydWUpO1xuXG4gIHRyeSB7XG4gICAgc3dpdGNoIChtZXRob2QpIHtcbiAgICAgIGNhc2UgJ0dFVCc6XG4gICAgICAgIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvY2hlY2stYXV0aCcpIHtcbiAgICAgICAgICByZXR1cm4gaGFuZGxlQ2hlY2tBdXRoKHJlcSwgcmVzKTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvYWN1c3RvbWVyJykge1xuICAgICAgICAgIHJldHVybiBhdXRoTWlkZGxld2FyZShoYW5kbGVHZXRDdXN0b21lcnMpKHJlcSwgcmVzKTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvYXByb2R1Y3RzJykge1xuICAgICAgICAgIHJldHVybiBoYW5kbGVHZXRQcm9kdWN0cyhyZXEsIHJlcyk7XG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2Fwcm9kdWN0LXByaWNlcycpIHtcbiAgICAgICAgICByZXR1cm4gaGFuZGxlR2V0UHJvZHVjdFByaWNlcyhyZXEsIHJlcyk7XG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL29yZGVycycpIHtcbiAgICAgICAgICByZXR1cm4gYXV0aE1pZGRsZXdhcmUoaGFuZGxlR2V0T3JkZXJzKShyZXEsIHJlcyk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7ICAgICBcblxuICAgICAgY2FzZSAnUE9TVCc6XG4gICAgICAgIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvbG9naW4nKSB7XG4gICAgICAgICAgcmV0dXJuIGhhbmRsZUxvZ0luKHJlcSwgcmVzKTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvdmFsaWRhdGUtcGluJykge1xuICAgICAgICAgIHJldHVybiBoYW5kbGVWYWxpZGF0ZVBpbihyZXEsIHJlcyk7XG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2xvZ291dCcpIHtcbiAgICAgICAgICByZXR1cm4gaGFuZGxlTG9nb3V0KHJlcSwgcmVzKTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvYWN1c3RvbWVyJykge1xuICAgICAgICAgIHJldHVybiBhdXRoTWlkZGxld2FyZShoYW5kbGVBZGRDdXN0b21lcikocmVxLCByZXMpO1xuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9vcmRlcnMnKSB7XG4gICAgICAgICAgcmV0dXJuIGF1dGhNaWRkbGV3YXJlKGhhbmRsZUdldE9yZGVycykocmVxLCByZXMpO1xuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zaWdudXAnKSB7XG4gICAgICAgICAgcmV0dXJuIGhhbmRsZVBvc3RTaWdudXAocmVxLCByZXMpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdQVVQnOlxuICAgICAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9hcHJvZHVjdC8nKSkge1xuICAgICAgICAgIGNvbnN0IGlkID0gcGF0aG5hbWUuc3BsaXQoJy8nKS5wb3AoKTtcbiAgICAgICAgICByZXR1cm4gYXV0aE1pZGRsZXdhcmUoaGFuZGxlVXBkYXRlUHJvZHVjdCkocmVxLCByZXMsIGlkKTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL2FjdXN0b21lci8nKSkge1xuICAgICAgICAgIGNvbnN0IGN1c3RvbWVySWQgPSBwYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpO1xuICAgICAgICAgIHJldHVybiBhdXRoTWlkZGxld2FyZShoYW5kbGVVcGRhdGVDdXN0b21lcikocmVxLCByZXMsIGN1c3RvbWVySWQpO1xuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9vcmRlcnMnKSB7XG4gICAgICAgICAgcmV0dXJuIGF1dGhNaWRkbGV3YXJlKGhhbmRsZUFkZE9yZGVyKShyZXEsIHJlcyk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ0RFTEVURSc6XG4gICAgICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL2Fwcm9kdWN0LycpKSB7XG4gICAgICAgICAgY29uc3QgaWQgPSBwYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpO1xuICAgICAgICAgIHJldHVybiBhdXRoTWlkZGxld2FyZShoYW5kbGVEZWxldGVQcm9kdWN0KShyZXEsIHJlcywgaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvYWN1c3RvbWVyLycpKSB7XG4gICAgICAgICAgY29uc3QgY3VzdG9tZXJJZCA9IHBhdGhuYW1lLnNwbGl0KCcvJykucG9wKCk7XG4gICAgICAgICAgcmV0dXJuIGF1dGhNaWRkbGV3YXJlKGhhbmRsZURlbGV0ZUN1c3RvbWVyKShyZXEsIHJlcywgY3VzdG9tZXJJZCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgWydHRVQnLCAnUE9TVCcsICdQVVQnLCAnREVMRVRFJ10pO1xuICAgICAgICByZXMuc3RhdHVzKDQwNSkuZW5kKGBNZXRob2QgJHttZXRob2R9IE5vdCBBbGxvd2VkYCk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdCcgfSk7XG4gIH1cbn1cblxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVMb2dJbihyZXEsIHJlcykge1xuICBjb25zdCB7IGVtYWlsYWRkcmVzcywgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuXG4gIHRyeSB7XG4gICAgLy8gSW5wdXQgdmFsaWRhdGlvblxuICAgIGlmICghZW1haWxhZGRyZXNzIHx8ICFwYXNzd29yZCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdFbWFpbCBhbmQgcGFzc3dvcmQgYXJlIHJlcXVpcmVkJyB9KTtcbiAgICB9XG5cbiAgICAvLyBRdWVyeSB0aGUgZGF0YWJhc2VcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gYWN1c3RvbWVyIFdIRVJFIGVtYWlsYWRkcmVzcyA9ID8nLCBcbiAgICAgIFtlbWFpbGFkZHJlc3NdXG4gICAgKTtcblxuICAgIC8vIENoZWNrIGlmIHVzZXIgZXhpc3RzIGFuZCBwYXNzd29yZCBtYXRjaGVzXG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDAgfHwgIShhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgcmVzdWx0WzBdLnBhc3N3b3JkKSkpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZCcgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgdXNlciA9IHJlc3VsdFswXTtcbiAgICBcbiAgICAvLyBDcmVhdGUgSldUIHRva2VuIC0gaW5jbHVkZSBjdXN0b21lcmlkXG4gICAgY29uc3QgdG9rZW4gPSBzaWduKFxuICAgICAgeyBcbiAgICAgICAgdXNlcklkOiB1c2VyLmlkLCBcbiAgICAgICAgY3VzdG9tZXJpZDogdXNlci5jdXN0b21lcmlkLCAvLyBBZGQgdGhpc1xuICAgICAgICBlbWFpbDogdXNlci5lbWFpbGFkZHJlc3MsIFxuICAgICAgICByb2xlOiB1c2VyLnJvbGUgXG4gICAgICB9LCBcbiAgICAgIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIFxuICAgICAgeyBleHBpcmVzSW46ICc1aCcgfVxuICAgICk7XG5cbiAgICAvLyBTZXQgY29va2llXG4gICAgcmVzLnNldEhlYWRlcihcbiAgICAgICdTZXQtQ29va2llJywgXG4gICAgICBgdG9rZW49JHt0b2tlbn07IEh0dHBPbmx5OyBQYXRoPS87IE1heC1BZ2U9MTgwMDA7IFNhbWVTaXRlPVN0cmljdGBcbiAgICApO1xuXG4gICAgLy8gU2VuZCBzdWNjZXNzIHJlc3BvbnNlXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxuICAgICAgbWVzc2FnZTogJ0xvZ2luIHN1Y2Nlc3NmdWwnLFxuICAgICAgY3VzdG9tZXJpZDogdXNlci5jdXN0b21lcmlkLCAvLyBBZGQgdGhpc1xuICAgICAgdXNlcjoge1xuICAgICAgICBlbWFpbGFkZHJlc3M6IHVzZXIuZW1haWxhZGRyZXNzLFxuICAgICAgICBmdWxsbmFtZTogdXNlci5mdWxsbmFtZSxcbiAgICAgICAgcm9sZTogdXNlci5yb2xlXG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignTG9naW4gZXJyb3I6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgbG9naW4nIH0pO1xuICB9XG59XG5cblxuXG5mdW5jdGlvbiBoYW5kbGVDaGVja0F1dGgocmVxLCByZXMpIHtcbiAgY29uc3QgdG9rZW4gPSByZXEuY29va2llcy50b2tlbjtcblxuICBpZiAoIXRva2VuKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgZGVjb2RlZCA9IHZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXG4gICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXG4gICAgICBjdXN0b21lcmlkOiBkZWNvZGVkLmN1c3RvbWVyaWQgLy8gQWRkIHRoaXNcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlIH0pO1xuICB9XG59XG5cblxuLy8gTG9nb3V0XG5hc3luYyBmdW5jdGlvbiBoYW5kbGVMb2dvdXQocmVxLCByZXMpIHtcbiAgdHJ5IHtcbiAgICAvLyBDbGVhciB0aGUgYXV0aGVudGljYXRpb24gY29va2llXG4gICAgcmVzLnNldEhlYWRlcihcbiAgICAgICdTZXQtQ29va2llJyxcbiAgICAgICd0b2tlbj07IFBhdGg9LzsgSHR0cE9ubHk7IEV4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVQ7IFNhbWVTaXRlPVN0cmljdCdcbiAgICApO1xuXG4gICAgLy8gU2VuZCBzdWNjZXNzIHJlc3BvbnNlXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiAnTG9nb3V0IHN1Y2Nlc3NmdWwnIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ291dCBlcnJvcjonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIGR1cmluZyBsb2dvdXQnIH0pO1xuICB9XG59XG5cblxuLy8gU2lnbnVwXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVQb3N0U2lnbnVwKHJlcSwgcmVzKSB7XG4gIGNvbnN0IHsgZnVsbG5hbWUsIGNvbnRhY3RudW1iZXIsIGVtYWlsYWRkcmVzcywgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuXG4gIC8vIFBlcmZvcm0gYmFzaWMgdmFsaWRhdGlvblxuICBpZiAoIWZ1bGxuYW1lIHx8ICFjb250YWN0bnVtYmVyIHx8ICFlbWFpbGFkZHJlc3MgfHwgIXBhc3N3b3JkKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICBlcnJvcjogJ0FsbCBmaWVsZHMgYXJlIHJlcXVpcmVkJyxcbiAgICAgIG1pc3Npbmc6IHtcbiAgICAgICAgZnVsbG5hbWU6ICFmdWxsbmFtZSxcbiAgICAgICAgY29udGFjdG51bWJlcjogIWNvbnRhY3RudW1iZXIsXG4gICAgICAgIGVtYWlsYWRkcmVzczogIWVtYWlsYWRkcmVzcyxcbiAgICAgICAgcGFzc3dvcmQ6ICFwYXNzd29yZFxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyBDaGVjayBpZiB0aGUgdXNlciBhbHJlYWR5IGV4aXN0c1xuICAgIGNvbnN0IFtleGlzdGluZ1VzZXJdID0gYXdhaXQgZGIucXVlcnkoXG4gICAgICAnU0VMRUNUICogRlJPTSBhY3VzdG9tZXIgV0hFUkUgZW1haWxhZGRyZXNzID0gPycsIFxuICAgICAgW2VtYWlsYWRkcmVzc11cbiAgICApO1xuICAgIFxuICAgIGlmIChleGlzdGluZ1VzZXIubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA5KS5qc29uKHsgZXJyb3I6ICdVc2VyIGFscmVhZHkgZXhpc3RzJyB9KTtcbiAgICB9XG5cbiAgICAvLyBIYXNoIHRoZSBwYXNzd29yZFxuICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKTtcblxuICAgIC8vIEluc2VydCBuZXcgdXNlclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoXG4gICAgICAnSU5TRVJUIElOVE8gYWN1c3RvbWVyIChmdWxsbmFtZSwgY29udGFjdG51bWJlciwgZW1haWxhZGRyZXNzLCBwYXNzd29yZCkgVkFMVUVTICg/LCA/LCA/LCA/KScsXG4gICAgICBbZnVsbG5hbWUsIGNvbnRhY3RudW1iZXIsIGVtYWlsYWRkcmVzcywgaGFzaGVkUGFzc3dvcmRdXG4gICAgKTtcblxuICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHsgXG4gICAgICBzdWNjZXNzOiB0cnVlLCBcbiAgICAgIG1lc3NhZ2U6ICdTaWdudXAgc3VjY2Vzc2Z1bCcsIFxuICAgICAgdXNlcklkOiByZXN1bHQuaW5zZXJ0SWQgXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGR1cmluZyBzaWdudXA6XCIsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgY3JlYXRpbmcgdGhlIHVzZXInIH0pO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFByb2R1Y3RQcmljZXMocmVxLCByZXMpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBbcHJpY2VzXSA9IGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICAgIFNFTEVDVCBcbiAgICAgICAgYXAucHJpY2VpZCxcbiAgICAgICAgYXAucHJvZHVjdGlkLFxuICAgICAgICBhcC53ZWlnaHQsXG4gICAgICAgIENBU1QoYXAucHJpY2UgQVMgREVDSU1BTCgxMCwyKSkgYXMgcHJpY2UsXG4gICAgICAgIGFwLmRlc2NyaXB0aW9uLFxuICAgICAgICBwLmltYWdlVXJsLFxuICAgICAgICBwLm5hbWUgYXMgcHJvZHVjdE5hbWVcbiAgICAgIEZST00gYXByb2R1Y3RfcHJpY2VzIGFwXG4gICAgICBKT0lOIGFwcm9kdWN0cyBwIE9OIGFwLnByb2R1Y3RpZCA9IHAucHJvZHVjdGlkXG4gICAgYCk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0ZldGNoZWQgcHJpY2VzIHdpdGggcHJvZHVjdCBkYXRhOicsIHByaWNlcyk7XG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJpY2VzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwcm9kdWN0IHByaWNlczonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3QgcHJpY2VzJyB9KTtcbiAgfVxufVxuXG4vLyBVcGRhdGUgaGFuZGxlR2V0UHJvZHVjdHMgdG8gaW5jbHVkZSBtb3JlIGRldGFpbHNcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFByb2R1Y3RzKHJlcSwgcmVzKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgW3Byb2R1Y3RzXSA9IGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICAgIFNFTEVDVCBcbiAgICAgICAgcC5wcm9kdWN0aWQsXG4gICAgICAgIHAubmFtZSxcbiAgICAgICAgcC5kZXNjcmlwdGlvbixcbiAgICAgICAgcC5pbWFnZVVybCxcbiAgICAgICAgcC5jYXRlZ29yeVxuICAgICAgRlJPTSBhcHJvZHVjdHMgcFxuICAgIGApO1xuICAgIGNvbnNvbGUubG9nKCdGZXRjaGVkIHByb2R1Y3RzOicsIHByb2R1Y3RzKTtcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihwcm9kdWN0cyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdHM6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBmZXRjaGluZyBwcm9kdWN0cycgfSk7XG4gIH1cbn1cblxuXG4vLyBGdW5jdGlvbiB0byBnZW5lcmF0ZSB0cmFja2luZyBudW1iZXJcbmZ1bmN0aW9uIGdlbmVyYXRlVHJhY2tpbmdOdW1iZXIoKSB7XG4gIGNvbnN0IHByZWZpeCA9ICdMQ0gnOyAvLyBQcmVmaXggZm9yIExlY2hvblxuICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpLnRvU3RyaW5nKCkuc2xpY2UoLTYpO1xuICBjb25zdCByYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKS50b1N0cmluZygpLnBhZFN0YXJ0KDMsICcwJyk7XG4gIHJldHVybiBgJHtwcmVmaXh9JHt0aW1lc3RhbXB9JHtyYW5kb219YDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlQWRkT3JkZXIocmVxLCByZXMpIHtcbiAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IGRiLmdldENvbm5lY3Rpb24oKTtcbiAgdHJ5IHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLmJlZ2luVHJhbnNhY3Rpb24oKTtcblxuICAgIGNvbnN0IHsgXG4gICAgICBjdXN0b21lcmlkLFxuICAgICAgaXRlbXMsXG4gICAgICB0b3RhbF9hbW91bnQsXG4gICAgICBwYXltZW50X21ldGhvZCxcbiAgICAgIGRlbGl2ZXJ5X2FkZHJlc3NcbiAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICBjb25zdCB0cmFja2luZ19udW1iZXIgPSBnZW5lcmF0ZVRyYWNraW5nTnVtYmVyKCk7XG5cbiAgICAvLyBHcm91cCBpdGVtcyBieSB0aGVpciBiYXNlIHByb2R1Y3RcbiAgICBjb25zdCBpdGVtc0J5UHJvZHVjdCA9IHt9O1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xuICAgICAgLy8gR2V0IHRoZSBiYXNlIHByb2R1Y3RpZCBmb3IgdGhpcyBwcmljZVxuICAgICAgY29uc3QgW3ByaWNlSW5mb10gPSBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KFxuICAgICAgICBgU0VMRUNUIGFwLnByb2R1Y3RpZCwgcC5uYW1lIFxuICAgICAgICAgRlJPTSBhcHJvZHVjdF9wcmljZXMgYXBcbiAgICAgICAgIEpPSU4gYXByb2R1Y3RzIHAgT04gYXAucHJvZHVjdGlkID0gcC5wcm9kdWN0aWRcbiAgICAgICAgIFdIRVJFIGFwLnByaWNlaWQgPSA/YCxcbiAgICAgICAgW2l0ZW0ucHJpY2VpZF1cbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNvbnN0IHByb2R1Y3RJZCA9IHByaWNlSW5mb1swXT8ucHJvZHVjdGlkO1xuICAgICAgaWYgKCFpdGVtc0J5UHJvZHVjdFtwcm9kdWN0SWRdKSB7XG4gICAgICAgIGl0ZW1zQnlQcm9kdWN0W3Byb2R1Y3RJZF0gPSB7XG4gICAgICAgICAgaXRlbXM6IFtdLFxuICAgICAgICAgIHRvdGFsUXVhbnRpdHk6IDAsXG4gICAgICAgICAgcHJvZHVjdE5hbWU6IHByaWNlSW5mb1swXT8ubmFtZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaXRlbXNCeVByb2R1Y3RbcHJvZHVjdElkXS5pdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgaXRlbXNCeVByb2R1Y3RbcHJvZHVjdElkXS50b3RhbFF1YW50aXR5ICs9IGl0ZW0ucXVhbnRpdHk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIG9yZGVycyBmb3IgZWFjaCB1bmlxdWUgcHJvZHVjdFxuICAgIGNvbnN0IG9yZGVySWRzID0gW107XG4gICAgZm9yIChjb25zdCBbcHJvZHVjdElkLCBwcm9kdWN0RGF0YV0gb2YgT2JqZWN0LmVudHJpZXMoaXRlbXNCeVByb2R1Y3QpKSB7XG4gICAgICAvLyBDYWxjdWxhdGUgdGhlIHN1YnRvdGFsIGZvciB0aGlzIHByb2R1Y3QncyBpdGVtc1xuICAgICAgY29uc3QgcHJvZHVjdFN1YnRvdGFsID0gcHJvZHVjdERhdGEuaXRlbXMucmVkdWNlKChzdW0sIGl0ZW0pID0+IFxuICAgICAgICBzdW0gKyAoaXRlbS5wcmljZSAqIGl0ZW0ucXVhbnRpdHkpLCAwXG4gICAgICApO1xuXG4gICAgICAvLyBJbnNlcnQgb3JkZXIgZm9yIHRoaXMgcHJvZHVjdFxuICAgICAgY29uc3QgW29yZGVyUmVzdWx0XSA9IGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICAgIGBJTlNFUlQgSU5UTyBvcmRlcnMgKFxuICAgICAgICAgIHRyYWNraW5nX251bWJlciwgXG4gICAgICAgICAgY3VzdG9tZXJpZCwgXG4gICAgICAgICAgcHJvZHVjdGlkLFxuICAgICAgICAgIHF1YW50aXR5LFxuICAgICAgICAgIHRvdGFsX2Ftb3VudCwgXG4gICAgICAgICAgcGF5bWVudF9tZXRob2QsIFxuICAgICAgICAgIGRlbGl2ZXJ5X2FkZHJlc3MsXG4gICAgICAgICAgc3RhdHVzXG4gICAgICAgICkgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/LCA/LCA/KWAsXG4gICAgICAgIFtcbiAgICAgICAgICB0cmFja2luZ19udW1iZXIsIFxuICAgICAgICAgIGN1c3RvbWVyaWQsXG4gICAgICAgICAgcHJvZHVjdElkLFxuICAgICAgICAgIHByb2R1Y3REYXRhLnRvdGFsUXVhbnRpdHksXG4gICAgICAgICAgcHJvZHVjdFN1YnRvdGFsLCAgLy8gU3RvcmUgdGhlIHN1YnRvdGFsIGZvciB0aGlzIHByb2R1Y3RcbiAgICAgICAgICBwYXltZW50X21ldGhvZCwgXG4gICAgICAgICAgZGVsaXZlcnlfYWRkcmVzcyxcbiAgICAgICAgICAnb3JkZXJfcGxhY2VkJ1xuICAgICAgICBdXG4gICAgICApO1xuXG4gICAgICBjb25zdCBvcmRlcmlkID0gb3JkZXJSZXN1bHQuaW5zZXJ0SWQ7XG4gICAgICBvcmRlcklkcy5wdXNoKG9yZGVyaWQpO1xuXG4gICAgICAvLyBJbnNlcnQgb3JkZXIgaXRlbXMgZm9yIHRoaXMgcHJvZHVjdFxuICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHByb2R1Y3REYXRhLml0ZW1zKSB7XG4gICAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoXG4gICAgICAgICAgYElOU0VSVCBJTlRPIG9yZGVyX2l0ZW1zIChcbiAgICAgICAgICAgIG9yZGVyaWQsIFxuICAgICAgICAgICAgcHJpY2VpZCwgXG4gICAgICAgICAgICBxdWFudGl0eSwgXG4gICAgICAgICAgICBwcmljZV9hdF90aW1lXG4gICAgICAgICAgKSBWQUxVRVMgKD8sID8sID8sID8pYCxcbiAgICAgICAgICBbXG4gICAgICAgICAgICBvcmRlcmlkLCBcbiAgICAgICAgICAgIGl0ZW0ucHJpY2VpZCwgXG4gICAgICAgICAgICBpdGVtLnF1YW50aXR5LCBcbiAgICAgICAgICAgIGl0ZW0ucHJpY2VcbiAgICAgICAgICBdXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXdhaXQgY29ubmVjdGlvbi5jb21taXQoKTtcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IFxuICAgICAgb3JkZXJpZHM6IG9yZGVySWRzLCBcbiAgICAgIHRyYWNraW5nX251bWJlcixcbiAgICAgIG1lc3NhZ2U6ICdPcmRlcnMgY3JlYXRlZCBzdWNjZXNzZnVsbHknIFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24ucm9sbGJhY2soKTtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBvcmRlcnM6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBjcmVhdGluZyBvcmRlcnMnIH0pO1xuICB9IGZpbmFsbHkge1xuICAgIGNvbm5lY3Rpb24ucmVsZWFzZSgpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldE9yZGVycyhyZXEsIHJlcykge1xuICB0cnkge1xuICAgIC8vIE1vZGlmaWVkIHF1ZXJ5IHRvIGluY2x1ZGUgY3VzdG9tZXIgZGV0YWlscyBmcm9tIGFjdXN0b21lciB0YWJsZVxuICAgIGNvbnN0IFtvcmRlcnNdID0gYXdhaXQgZGIucXVlcnkoYFxuICAgICAgU0VMRUNUIFxuICAgICAgICBvLiosXG4gICAgICAgIGMuZnVsbG5hbWUsXG4gICAgICAgIGMuY29udGFjdE51bWJlcixcbiAgICAgICAgYy5lbWFpbGFkZHJlc3NcbiAgICAgIEZST00gb3JkZXJzIG9cbiAgICAgIEpPSU4gYWN1c3RvbWVyIGMgT04gby5jdXN0b21lcmlkID0gYy5jdXN0b21lcmlkXG4gICAgICBPUkRFUiBCWSBvLmRhdGUgREVTQ1xuICAgIGApO1xuXG4gICAgLy8gRmV0Y2ggaXRlbXMgZm9yIGVhY2ggb3JkZXJcbiAgICBmb3IgKGxldCBvcmRlciBvZiBvcmRlcnMpIHtcbiAgICAgIGNvbnN0IFtpdGVtc10gPSBhd2FpdCBkYi5xdWVyeShgXG4gICAgICAgIFNFTEVDVCBcbiAgICAgICAgICBvaS4qLFxuICAgICAgICAgIGFwLndlaWdodCxcbiAgICAgICAgICBhcC5kZXNjcmlwdGlvbixcbiAgICAgICAgICBwLm5hbWUsXG4gICAgICAgICAgcC5pbWFnZVVybFxuICAgICAgICBGUk9NIG9yZGVyX2l0ZW1zIG9pXG4gICAgICAgIEpPSU4gYXByb2R1Y3RfcHJpY2VzIGFwIE9OIG9pLnByaWNlaWQgPSBhcC5wcmljZWlkXG4gICAgICAgIEpPSU4gYXByb2R1Y3RzIHAgT04gYXAucHJvZHVjdGlkID0gcC5wcm9kdWN0aWRcbiAgICAgICAgV0hFUkUgb2kub3JkZXJpZCA9ID9cbiAgICAgIGAsIFtvcmRlci5vcmRlcmlkXSk7XG4gICAgICBcbiAgICAgIG9yZGVyLml0ZW1zID0gaXRlbXM7XG4gICAgfVxuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ob3JkZXJzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBvcmRlcnM6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBmZXRjaGluZyBvcmRlcnMnIH0pO1xuICB9XG59XG5cbi8vIE90aGVyIGZ1bmN0aW9ucyAoaGFuZGxlR2V0Q3VzdG9tZXJzLCBoYW5kbGVBZGRPcmRlciwgZXRjLikgd291bGQgZ28gaGVyZSJdLCJuYW1lcyI6WyJteXNxbCIsInBhcnNlIiwic2lnbiIsInZlcmlmeSIsImF1dGhNaWRkbGV3YXJlIiwiYmNyeXB0IiwiZGIiLCJjcmVhdGVQb29sIiwiaG9zdCIsInByb2Nlc3MiLCJlbnYiLCJNWVNRTF9IT1NUIiwicG9ydCIsIk1ZU1FMX1BPUlQiLCJ1c2VyIiwiTVlTUUxfVVNFUiIsInBhc3N3b3JkIiwiTVlTUUxfUEFTU1dPUkQiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwid2FpdEZvckNvbm5lY3Rpb25zIiwiY29ubmVjdGlvbkxpbWl0IiwicXVldWVMaW1pdCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJwYXRobmFtZSIsInVybCIsImhhbmRsZUNoZWNrQXV0aCIsImhhbmRsZUdldEN1c3RvbWVycyIsImhhbmRsZUdldFByb2R1Y3RzIiwiaGFuZGxlR2V0UHJvZHVjdFByaWNlcyIsImhhbmRsZUdldE9yZGVycyIsImhhbmRsZUxvZ0luIiwiaGFuZGxlVmFsaWRhdGVQaW4iLCJoYW5kbGVMb2dvdXQiLCJoYW5kbGVBZGRDdXN0b21lciIsImhhbmRsZVBvc3RTaWdudXAiLCJzdGFydHNXaXRoIiwiaWQiLCJzcGxpdCIsInBvcCIsImhhbmRsZVVwZGF0ZVByb2R1Y3QiLCJjdXN0b21lcklkIiwiaGFuZGxlVXBkYXRlQ3VzdG9tZXIiLCJoYW5kbGVBZGRPcmRlciIsImhhbmRsZURlbGV0ZVByb2R1Y3QiLCJoYW5kbGVEZWxldGVDdXN0b21lciIsInNldEhlYWRlciIsInN0YXR1cyIsImVuZCIsImVycm9yIiwiY29uc29sZSIsImpzb24iLCJlbWFpbGFkZHJlc3MiLCJib2R5IiwicmVzdWx0IiwicXVlcnkiLCJsZW5ndGgiLCJjb21wYXJlIiwidG9rZW4iLCJ1c2VySWQiLCJjdXN0b21lcmlkIiwiZW1haWwiLCJyb2xlIiwiSldUX1NFQ1JFVCIsImV4cGlyZXNJbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZnVsbG5hbWUiLCJjb29raWVzIiwiaXNBdXRoZW50aWNhdGVkIiwiZGVjb2RlZCIsImNvbnRhY3RudW1iZXIiLCJtaXNzaW5nIiwiZXhpc3RpbmdVc2VyIiwiaGFzaGVkUGFzc3dvcmQiLCJoYXNoIiwiaW5zZXJ0SWQiLCJwcmljZXMiLCJsb2ciLCJwcm9kdWN0cyIsImdlbmVyYXRlVHJhY2tpbmdOdW1iZXIiLCJwcmVmaXgiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwidG9TdHJpbmciLCJzbGljZSIsInJhbmRvbSIsIk1hdGgiLCJmbG9vciIsInBhZFN0YXJ0IiwiY29ubmVjdGlvbiIsImdldENvbm5lY3Rpb24iLCJiZWdpblRyYW5zYWN0aW9uIiwiaXRlbXMiLCJ0b3RhbF9hbW91bnQiLCJwYXltZW50X21ldGhvZCIsImRlbGl2ZXJ5X2FkZHJlc3MiLCJ0cmFja2luZ19udW1iZXIiLCJpdGVtc0J5UHJvZHVjdCIsIml0ZW0iLCJwcmljZUluZm8iLCJwcmljZWlkIiwicHJvZHVjdElkIiwicHJvZHVjdGlkIiwidG90YWxRdWFudGl0eSIsInByb2R1Y3ROYW1lIiwibmFtZSIsInB1c2giLCJxdWFudGl0eSIsIm9yZGVySWRzIiwicHJvZHVjdERhdGEiLCJPYmplY3QiLCJlbnRyaWVzIiwicHJvZHVjdFN1YnRvdGFsIiwicmVkdWNlIiwic3VtIiwicHJpY2UiLCJvcmRlclJlc3VsdCIsIm9yZGVyaWQiLCJjb21taXQiLCJvcmRlcmlkcyIsInJvbGxiYWNrIiwicmVsZWFzZSIsIm9yZGVycyIsIm9yZGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/[...nextapi].js\n");

/***/ }),

/***/ "(api)/./src/utils/authMiddleware.js":
/*!*************************************!*\
  !*** ./src/utils/authMiddleware.js ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authMiddleware: () => (/* binding */ authMiddleware)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction authMiddleware(handler) {\n    return async (req, res)=>{\n        try {\n            const token = req.cookies.token;\n            if (!token) {\n                return res.status(401).json({\n                    error: \"Authentication required\"\n                });\n            }\n            const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__.verify)(token, process.env.JWT_SECRET);\n            req.userId = decoded.userId;\n            return handler(req, res);\n        } catch (error) {\n            console.error(\"Authentication error:\", error);\n            return res.status(401).json({\n                error: \"Invalid or expired token\"\n            });\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvdXRpbHMvYXV0aE1pZGRsZXdhcmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXNDO0FBRS9CLFNBQVNDLGVBQWVDLE9BQU87SUFDcEMsT0FBTyxPQUFPQyxLQUFLQztRQUNqQixJQUFJO1lBQ0YsTUFBTUMsUUFBUUYsSUFBSUcsT0FBTyxDQUFDRCxLQUFLO1lBRS9CLElBQUksQ0FBQ0EsT0FBTztnQkFDVixPQUFPRCxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFQyxPQUFPO2dCQUEwQjtZQUNqRTtZQUVBLE1BQU1DLFVBQVVWLG9EQUFNQSxDQUFDSyxPQUFPTSxRQUFRQyxHQUFHLENBQUNDLFVBQVU7WUFDcERWLElBQUlXLE1BQU0sR0FBR0osUUFBUUksTUFBTTtZQUUzQixPQUFPWixRQUFRQyxLQUFLQztRQUN0QixFQUFFLE9BQU9LLE9BQU87WUFDZE0sUUFBUU4sS0FBSyxDQUFDLHlCQUF5QkE7WUFDdkMsT0FBT0wsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUEyQjtRQUNsRTtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ydWJ5LWxldGNob24vLi9zcmMvdXRpbHMvYXV0aE1pZGRsZXdhcmUuanM/N2M2MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2ZXJpZnkgfSBmcm9tICdqc29ud2VidG9rZW4nO1xuXG5leHBvcnQgZnVuY3Rpb24gYXV0aE1pZGRsZXdhcmUoaGFuZGxlcikge1xuICByZXR1cm4gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRva2VuID0gcmVxLmNvb2tpZXMudG9rZW47XG5cbiAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xuICAgICAgcmVxLnVzZXJJZCA9IGRlY29kZWQudXNlcklkO1xuXG4gICAgICByZXR1cm4gaGFuZGxlcihyZXEsIHJlcyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGhlbnRpY2F0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCBvciBleHBpcmVkIHRva2VuJyB9KTtcbiAgICB9XG4gIH07XG59Il0sIm5hbWVzIjpbInZlcmlmeSIsImF1dGhNaWRkbGV3YXJlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInRva2VuIiwiY29va2llcyIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImRlY29kZWQiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsInVzZXJJZCIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/utils/authMiddleware.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();